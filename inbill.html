<style>
    body {
      width: 80mm;
      max-width: 80mm;
      font-family: monospace, monospace;
      font-size: 12pt;
      padding: 5mm;
    }
  
    h2 {
      text-align: center;
      margin-bottom: 10px;
      font-weight: bold;
      font-size: 14pt;
    }
  
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
    }
  
    th, td {
      padding: 6px 8px;
      border-bottom: 1px dashed #444;
    }
  
    th {
      text-align: left;
      font-weight: bold;
      background-color: #f5f5f5;
    }
  
    .denomination {
      width: 60%;
    }
  
    .count {
      width: 40%;
      text-align: right;
    }
  
    tfoot tr td {
      font-weight: bold;
      border-top: 2px solid #000;
      padding-top: 8px;
    }
  
    tfoot tr:first-child td {
      border-top: none;
    }
  
    /* Ẩn khi in */
    @media print {
      body {
        width: 80mm;
        max-width: 80mm;
        padding: 0;
        margin: 0;
        font-size: 10pt;
      }
    }
  </style>
  
  <h2 id="title">Tổng tiền mặt Ngày </h2>
  <table id="notesTable">
    <thead>
      <tr>
        <th>Mệnh giá</th>
        <th>Số tờ</th>
      </tr>
    </thead>
    <tbody>
      <!-- Dữ liệu sẽ được render ở đây -->
    </tbody>
    <tfoot>
      <!-- Tổng sẽ hiện ở đây -->
    </tfoot>
  </table>
  
<table id="notesTable">
  <tbody>
    <!-- Dữ liệu sẽ được render ở đây -->
  </tbody>
  <tfoot>
    <!-- Tổng sẽ hiện ở đây -->
  </tfoot>
</table>

<script>
const largeNotesJson = sessionStorage.getItem('largeNotesToPrint');
let largeNotes = [];

if (largeNotesJson) {
  try {
    largeNotes = JSON.parse(largeNotesJson);
  } catch {
    largeNotes = [];
  }
}

const tbody = document.querySelector("#notesTable tbody");
const tfoot = document.querySelector("#notesTable tfoot");

if (largeNotes.length === 0) {
  tbody.innerHTML = `<tr><td colspan="2" style="text-align:center;">Không có tờ >= 50k để in</td></tr>`;
  tfoot.innerHTML = '';  // Không có tổng
} else {
  let totalCount = 0;
  let totalAmount = 0;

  largeNotes.forEach(item => {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td class="denomination">${item.denomination.toLocaleString('vi-VN')}đ</td><td class="count">${item.count}</td>`;
    tbody.appendChild(tr);

    totalCount += item.count;
    totalAmount += item.count * item.denomination;
  });

  // Tạo footer tổng
  tfoot.innerHTML = `
    <tr style="font-weight:bold; border-top:1px solid #000;">
      <td>Tổng số tờ</td>
      <td style="text-align:right;">${totalCount}</td>
    </tr>
    <tr style="font-weight:bold; border-top:1px solid #000;">
      <td>Tổng tiền</td>
      <td style="text-align:right;">${totalAmount.toLocaleString('vi-VN')}đ</td>
    </tr>
  `;
}
const now = new Date();
  // Format ngày giờ theo ý bạn, ví dụ dạng "13/08/2025 15:30:45"
  const formatted = now.toLocaleString('vi-VN', {
    day: '2-digit',
    month: '2-digit',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit',
  });

  document.getElementById('title').textContent = `Tổng tiền mặt Ngày ${formatted}`;
window.onload = () => {
  window.print();
};
</script>
